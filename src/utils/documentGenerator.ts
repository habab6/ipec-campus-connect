import { Student, Payment, Document } from "@/types";

export const generateInvoiceNumber = (): string => {
  const date = new Date();
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const timestamp = Date.now();
  return `IPEC-${year}${month}-${timestamp.toString().slice(-6)}`;
};

export const generateCreditNoteNumber = (): string => {
  const date = new Date();
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const timestamp = Date.now();
  return `CN-${year}${month}-${timestamp.toString().slice(-6)}`;
};

export const generateRegistrationDocument = (student: Student): string => {
  const currentDate = new Date();
  const documentNumber = `ATT-${currentDate.getFullYear()}-${currentDate.getMonth() + 1}-${currentDate.getDate()}-${currentDate.getTime().toString().slice(-4)}`;
  
  return `
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attestation d'Inscription - IPEC</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: Arial, sans-serif; 
            line-height: 1.3; 
            color: #000;
            font-size: 10pt;
        }
        
        .header {
            text-align: center;
            margin-bottom: 0.8cm;
            padding-bottom: 0.3cm;
            border-bottom: 1px solid #000;
        }
        
        .logo {
            font-size: 18pt;
            font-weight: bold;
            color: #000;
            margin-bottom: 3px;
        }
        
        .institution {
            font-size: 11pt;
            margin-bottom: 8px;
        }
        
        .document-title {
            font-size: 14pt;
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .document-number {
            font-size: 9pt;
        }
        
        .date-location {
            text-align: right;
            margin: 0.3cm 0;
            font-size: 10pt;
        }
        
        .certification {
            text-align: justify;
            font-size: 10pt;
            line-height: 1.4;
            margin-bottom: 0.5cm;
        }
        
        .student-details {
            margin: 0.4cm 0;
        }
        
        .detail-row {
            display: flex;
            margin-bottom: 2px;
            font-size: 10pt;
        }
        
        .label {
            font-weight: bold;
            width: 3cm;
            flex-shrink: 0;
        }
        
        .value {
            flex-grow: 1;
        }
        
        .program-section {
            text-align: center;
            margin: 0.4cm 0;
            padding: 8px;
            background: #f5f5f5;
        }
        
        .program-title {
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .program-details {
            font-size: 10pt;
        }
        
        .validity-text {
            text-align: center;
            font-style: italic;
            margin: 0.4cm 0;
            font-size: 10pt;
        }
        
        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 0.6cm;
        }
        
        .signature-block {
            text-align: center;
            width: 5cm;
        }
        
        .signature-line {
            border-bottom: 1px solid #000;
            height: 1cm;
            margin-bottom: 5px;
        }
        
        .signature-label {
            font-size: 9pt;
        }
        
        .footer {
            text-align: center;
            margin-top: 0.5cm;
            padding-top: 0.3cm;
            border-top: 1px solid #ccc;
            font-size: 9pt;
        }
        
        @media print {
            body { margin: 0; padding: 0; }
            .signature-section { page-break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="133.38 166.96 283.24 136.08" style="height: 30px; width: auto; fill: #000; vertical-align: middle;">
                <g><g><path d="M141.75727,294.56678v-7.1336h1.10061v7.1336z" fill-rule="nonzero"/><path d="M150.30061,294.56678l-3.83176,-5.08524v5.08524h-1.08023v-7.1336h0.86622l3.86234,5.07505v-5.07505h1.08023v7.1336z" fill-rule="nonzero"/><path d="M157.95735,289.15543c-0.19023,-0.23099 -0.39914,-0.39744 -0.62674,-0.49935c-0.2276,-0.10191 -0.49426,-0.15286 -0.79998,-0.15286c-0.39405,0 -0.70147,0.07643 -0.92227,0.22929c-0.2208,0.15286 -0.3312,0.338 -0.3312,0.5554c0,0.13588 0.04926,0.25647 0.14777,0.36178c0.09851,0.10531 0.2259,0.20042 0.38216,0.28534c0.15626,0.08492 0.32611,0.16475 0.50954,0.23949c0.18344,0.07473 0.36347,0.14267 0.54012,0.20382h-0.01019c0.19702,0.06794 0.41952,0.15626 0.6675,0.26496c0.24798,0.1087 0.48237,0.24798 0.70317,0.41783c0.2208,0.16985 0.40763,0.37366 0.5605,0.61145c0.15286,0.23779 0.22929,0.51973 0.22929,0.84584c0,0.3397 -0.06454,0.64033 -0.19363,0.90189c-0.12908,0.26157 -0.30912,0.48067 -0.54012,0.65731c-0.23099,0.17664 -0.50105,0.31082 -0.81017,0.40254c-0.30912,0.09172 -0.64372,0.13758 -1.0038,0.13758c-0.50954,0 -0.98512,-0.1087 -1.42672,-0.32611c-0.4416,-0.21741 -0.87641,-0.56389 -1.30443,-1.03947l0.8968,-0.73374c0.24458,0.3397 0.52143,0.58767 0.83056,0.74393c0.30912,0.15626 0.64712,0.23439 1.01399,0.23439c0.21061,0 0.40254,-0.02038 0.57578,-0.06115c0.17324,-0.04076 0.32271,-0.09851 0.4484,-0.17324c0.12569,-0.07473 0.2242,-0.16305 0.29554,-0.26496c0.07134,-0.10191 0.107,-0.21401 0.107,-0.3363c0,-0.16985 -0.05095,-0.31931 -0.15286,-0.4484c-0.10191,-0.12908 -0.23099,-0.24288 -0.38725,-0.34139c-0.15626,-0.09851 -0.3329,-0.18344 -0.52992,-0.25477c-0.19702,-0.07134 -0.38725,-0.13758 -0.57069,-0.19872l-0.24458,-0.09172c-0.23099,-0.08153 -0.45689,-0.16815 -0.67769,-0.25987c-0.2208,-0.09172 -0.41952,-0.21061 -0.59617,-0.35668c-0.17664,-0.14607 -0.31931,-0.32781 -0.42802,-0.54521c-0.1087,-0.21741 -0.16305,-0.48576 -0.16305,-0.80508c0,-0.25137 0.04416,-0.49596 0.13248,-0.73374c0.08832,-0.23779 0.2276,-0.4467 0.41783,-0.62674c0.19023,-0.18004 0.43481,-0.32441 0.73374,-0.43311c0.29893,-0.1087 0.65901,-0.16305 1.08023,-0.16305c0.24458,0 0.47897,0.02038 0.70317,0.06115c0.2242,0.04076 0.4416,0.1104 0.65222,0.20891c0.21061,0.09851 0.41613,0.2276 0.61655,0.38725c0.20042,0.15966 0.39914,0.35838 0.59617,0.59617l-0.94775,0.75412z" fill-rule="nonzero"/><path d="M164.40137,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/><path d="M168.59321,294.56678v-7.1336h1.10061v7.1336z" fill-rule="nonzero"/><path d="M175.01685,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/><path d="M182.09271,294.63812c-0.17664,0 -0.3397,-0.01019 -0.48916,-0.03057c-0.3329,-0.04756 -0.64202,-0.13588 -0.92737,-0.26496c-0.28534,-0.12908 -0.53502,-0.29723 -0.74903,-0.50445c-0.21401,-0.20721 -0.38386,-0.45179 -0.50954,-0.73374c-0.12569,-0.28195 -0.19532,-0.59617 -0.20891,-0.94265v-4.72856h1.10061v4.61646c0,0.24458 0.04246,0.45519 0.12739,0.63183c0.08492,0.17664 0.19872,0.32441 0.34139,0.4433c0.14267,0.11889 0.30912,0.21061 0.49935,0.27515c0.19023,0.06454 0.39405,0.107 0.61145,0.12739c0.03397,0.00679 0.05945,0.01019 0.07643,0.01019c0.01698,0 0.03567,0 0.05605,0h0.15286c0.02038,0 0.03906,0 0.05605,0c0.01698,0 0.04246,-0.0034 0.07643,-0.01019c0.21741,-0.02038 0.42292,-0.06284 0.61655,-0.12739c0.19363,-0.06454 0.36178,-0.15626 0.50445,-0.27515c0.14267,-0.11889 0.25647,-0.26666 0.34139,-0.4433c0.08492,-0.17664 0.12739,-0.38725 0.12739,-0.63183v-4.61646h1.10061v4.72856c-0.01359,0.34649 -0.08323,0.66071 -0.20891,0.94265c-0.12569,0.28195 -0.29554,0.52823 -0.50954,0.73884c-0.21401,0.21061 -0.46538,0.38046 -0.75412,0.50954c-0.28874,0.12908 -0.60296,0.21401 -0.94265,0.25477l-0.35668,0.03057z" fill-rule="nonzero"/><path d="M190.32013,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/><path d="M200.29359,291.68277v2.88401h-1.09042v-7.1336h2.70058c0.29214,0 0.56729,0.05605 0.82546,0.16815c0.25817,0.1121 0.48407,0.26496 0.67769,0.45859c0.19363,0.19363 0.34649,0.41952 0.45859,0.67769c0.1121,0.25817 0.16815,0.53332 0.16815,0.82546c0,0.29214 -0.05605,0.56729 -0.16815,0.82546c-0.1121,0.25817 -0.26496,0.48237 -0.45859,0.6726c-0.19363,0.19023 -0.41952,0.34139 -0.67769,0.45349c-0.25817,0.1121 -0.53332,0.16815 -0.82546,0.16815zM200.29359,290.58215h1.61016c0.14267,0 0.27515,-0.02548 0.39744,-0.07643c0.12229,-0.05095 0.23099,-0.12229 0.32611,-0.21401c0.09511,-0.09172 0.16985,-0.20042 0.2242,-0.32611c0.05435,-0.12569 0.08153,-0.25987 0.08153,-0.40254c0,-0.14267 -0.02718,-0.27515 -0.08153,-0.39744c-0.05435,-0.12229 -0.12908,-0.22929 -0.2242,-0.32101c-0.09511,-0.09172 -0.20382,-0.16645 -0.32611,-0.2242c-0.12229,-0.05775 -0.25477,-0.08662 -0.39744,-0.08662h-1.61016z" fill-rule="nonzero"/><path d="M208.93884,291.68277h-1.27386v2.88401h-1.10061v-7.1336h2.71077c0.29214,0 0.56559,0.05605 0.82036,0.16815c0.25477,0.1121 0.47897,0.26496 0.6726,0.45859c0.19363,0.19363 0.34649,0.41952 0.45859,0.67769c0.1121,0.25817 0.16815,0.53332 0.16815,0.82546c0,0.42802 -0.11719,0.81527 -0.35158,1.16176c-0.23439,0.34649 -0.53162,0.60466 -0.8917,0.77451l1.61016,3.06745h-1.24329zM207.66498,290.58215h1.61016c0.14267,0 0.27515,-0.02548 0.39744,-0.07643c0.12229,-0.05095 0.22929,-0.12229 0.32101,-0.21401c0.09172,-0.09172 0.16475,-0.20042 0.2191,-0.32611c0.05435,-0.12569 0.08153,-0.25987 0.08153,-0.40254c0,-0.28534 -0.09851,-0.52653 -0.29554,-0.72355c-0.19702,-0.19702 -0.43821,-0.29893 -0.72355,-0.30573h-1.61016z" fill-rule="nonzero"/><path d="M214.29244,294.56678v-7.1336h1.10061v7.1336z" fill-rule="nonzero"/><path d="M220.99124,292.61013c0.30573,-0.86962 0.61315,-1.73584 0.92227,-2.59867c0.30912,-0.86283 0.61655,-1.72226 0.92227,-2.57829h1.2229l-2.54772,7.1336h-1.03947l-2.54772,-7.1336h1.2229z" fill-rule="nonzero"/><path d="M226.58942,294.56678v-7.1336h4.40245v1.10061h-3.30184v1.7834h3.0063v1.10061h-3.0063v2.04836h3.33241v1.10061zM227.82251,286.58733l0.94775,-1.15157h1.0089l-0.95794,1.15157z" fill-rule="nonzero"/><path d="M244.31812,290.9796c0,0.49596 -0.07134,0.96134 -0.21401,1.39615c-0.14267,0.43481 -0.35838,0.81527 -0.64712,1.14138c-0.28874,0.32611 -0.64712,0.58258 -1.07514,0.76941c-0.42802,0.18683 -0.92737,0.28025 -1.49806,0.28025h-2.63943v-7.1336h2.63943c0.59107,0 1.10231,0.09511 1.53372,0.28534c0.43141,0.19023 0.78809,0.4467 1.07004,0.76941c0.28195,0.32271 0.49086,0.69807 0.62674,1.12609c0.13588,0.42802 0.20382,0.88321 0.20382,1.36558zM243.19713,290.98979c0,-0.77451 -0.21061,-1.37747 -0.63183,-1.80888c-0.42122,-0.43141 -0.99531,-0.64712 -1.72226,-0.64712h-1.49806v4.93238h1.49806c0.39405,0 0.73714,-0.05945 1.02928,-0.17834c0.29214,-0.11889 0.53672,-0.28534 0.73374,-0.49935c0.19702,-0.21401 0.34479,-0.47388 0.4433,-0.7796c0.09851,-0.30573 0.14777,-0.64542 0.14777,-1.01909z" fill-rule="nonzero"/><path d="M246.84885,294.56678v-7.1336h4.40245v1.10061h-3.30184v1.7834h3.0063v1.10061h-3.0063v2.04836h3.33241v1.10061z" fill-rule="nonzero"/><path d="M258.04182,289.15543c-0.19023,-0.23099 -0.39914,-0.39744 -0.62674,-0.49935c-0.2276,-0.10191 -0.49426,-0.15286 -0.79998,-0.15286c-0.39405,0 -0.70147,0.07643 -0.92227,0.22929c-0.2208,0.15286 -0.3312,0.338 -0.3312,0.5554c0,0.13588 0.04926,0.25647 0.14777,0.36178c0.09851,0.10531 0.2259,0.20042 0.38216,0.28534c0.15626,0.08492 0.32611,0.16475 0.50954,0.23949c0.18344,0.07473 0.36347,0.14267 0.54012,0.20382h-0.01019c0.19702,0.06794 0.41952,0.15626 0.6675,0.26496c0.24798,0.1087 0.48237,0.24798 0.70317,0.41783c0.2208,0.16985 0.40763,0.37366 0.5605,0.61145c0.15286,0.23779 0.22929,0.51973 0.22929,0.84584c0,0.3397 -0.06454,0.64033 -0.19363,0.90189c-0.12908,0.26157 -0.30912,0.48067 -0.54012,0.65731c-0.23099,0.17664 -0.50105,0.31082 -0.81017,0.40254c-0.30912,0.09172 -0.64372,0.13758 -1.0038,0.13758c-0.50954,0 -0.98512,-0.1087 -1.42672,-0.32611c-0.4416,-0.21741 -0.87641,-0.56389 -1.30443,-1.03947l0.8968,-0.73374c0.24458,0.3397 0.52143,0.58767 0.83056,0.74393c0.30912,0.15626 0.64712,0.23439 1.01399,0.23439c0.21061,0 0.40254,-0.02038 0.57578,-0.06115c0.17324,-0.04076 0.32271,-0.09851 0.4484,-0.17324c0.12569,-0.07473 0.2242,-0.16305 0.29554,-0.26496c0.07134,-0.10191 0.107,-0.21401 0.107,-0.3363c0,-0.16985 -0.05095,-0.31931 -0.15286,-0.4484c-0.10191,-0.12908 -0.23099,-0.24288 -0.38725,-0.34139c-0.15626,-0.09851 -0.3329,-0.18344 -0.52992,-0.25477c-0.19702,-0.07134 -0.38725,-0.13758 -0.57069,-0.19872l-0.24458,-0.09172c-0.23099,-0.08153 -0.45689,-0.16815 -0.67769,-0.25987c-0.2208,-0.09172 -0.41952,-0.21061 -0.59617,-0.35668c-0.17664,-0.14607 -0.31931,-0.32781 -0.42802,-0.54521c-0.1087,-0.21741 -0.16305,-0.48576 -0.16305,-0.80508c0,-0.25137 0.04416,-0.49596 0.13248,-0.73374c0.08832,-0.23779 0.2276,-0.4467 0.41783,-0.62674c0.19023,-0.18004 0.43481,-0.32441 0.73374,-0.43311c0.29893,-0.1087 0.65901,-0.16305 1.08023,-0.16305c0.24458,0 0.47897,0.02038 0.70317,0.06115c0.2242,0.04076 0.4416,0.1104 0.65222,0.20891c0.21061,0.09851 0.41613,0.2276 0.61655,0.38725c0.20042,0.15966 0.39914,0.35838 0.59617,0.59617l-0.94775,0.75412z" fill-rule="nonzero"/><path d="M266.38474,294.56678v-7.1336h4.40245v1.10061h-3.30184v1.7834h3.0063v1.10061h-3.0063v2.04836h3.33241v1.10061zM267.61783,286.58733l0.94775,-1.15157h1.0089l-0.95794,1.15157z" fill-rule="nonzero"/><path d="M276.14079,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/><path d="M283.21665,294.63812c-0.17664,0 -0.3397,-0.01019 -0.48916,-0.03057c-0.3329,-0.04756 -0.64202,-0.13588 -0.92737,-0.26496c-0.28534,-0.12908 -0.53502,-0.29723 -0.74903,-0.50445c-0.21401,-0.20721 -0.38386,-0.45179 -0.50954,-0.73374c-0.12569,-0.28195 -0.19532,-0.59617 -0.20891,-0.94265v-4.72856h1.10061v4.61646c0,0.24458 0.04246,0.45519 0.12739,0.63183c0.08492,0.17664 0.19872,0.32441 0.34139,0.4433c0.14267,0.11889 0.30912,0.21061 0.49935,0.27515c0.19023,0.06454 0.39405,0.107 0.61145,0.12739c0.03397,0.00679 0.05945,0.01019 0.07643,0.01019c0.01698,0 0.03567,0 0.05605,0h0.15286c0.02038,0 0.03906,0 0.05605,0c0.01698,0 0.04246,-0.0034 0.07643,-0.01019c0.21741,-0.02038 0.42292,-0.06284 0.61655,-0.12739c0.19363,-0.06454 0.36178,-0.15626 0.50445,-0.27515c0.14267,-0.11889 0.25647,-0.26666 0.34139,-0.4433c0.08492,-0.17664 0.12739,-0.38725 0.12739,-0.63183v-4.61646h1.10061v4.72856c-0.01359,0.34649 -0.08323,0.66071 -0.20891,0.94265c-0.12569,0.28195 -0.29554,0.52823 -0.50954,0.73884c-0.21401,0.21061 -0.46538,0.38046 -0.75412,0.50954c-0.28874,0.12908 -0.60296,0.21401 -0.94265,0.25477l-0.35668,0.03057z" fill-rule="nonzero"/><path d="M294.72553,290.9796c0,0.49596 -0.07134,0.96134 -0.21401,1.39615c-0.14267,0.43481 -0.35838,0.81527 -0.64712,1.14138c-0.28874,0.32611 -0.64712,0.58258 -1.07514,0.76941c-0.42802,0.18683 -0.92737,0.28025 -1.49806,0.28025h-2.63943v-7.1336h2.63943c0.59107,0 1.10231,0.09511 1.53372,0.28534c0.43141,0.19023 0.78809,0.4467 1.07004,0.76941c0.28195,0.32271 0.49086,0.69807 0.62674,1.12609c0.13588,0.42802 0.20382,0.88321 0.20382,1.36558zM293.60454,290.98979c0,-0.77451 -0.21061,-1.37747 -0.63183,-1.80888c-0.42122,-0.43141 -0.99531,-0.64712 -1.72226,-0.64712h-1.49806v4.93238h1.49806c0.39405,0 0.73714,-0.05945 1.02928,-0.17834c0.29214,-0.11889 0.53672,-0.28534 0.73374,-0.49935c0.19702,-0.21401 0.34479,-0.47388 0.4433,-0.7796c0.09851,-0.30573 0.14777,-0.64542 0.14777,-1.01909z" fill-rule="nonzero"/><path d="M297.25626,294.56678v-7.1336h4.40245v1.10061h-3.30184v1.7834h3.0063v1.10061h-3.0063v2.04836h3.33241v1.10061z" fill-rule="nonzero"/><path d="M308.44923,289.15543c-0.19023,-0.23099 -0.39914,-0.39744 -0.62674,-0.49935c-0.2276,-0.10191 -0.49426,-0.15286 -0.79998,-0.15286c-0.39405,0 -0.70147,0.07643 -0.92227,0.22929c-0.2208,0.15286 -0.3312,0.338 -0.3312,0.5554c0,0.13588 0.04926,0.25647 0.14777,0.36178c0.09851,0.10531 0.2259,0.20042 0.38216,0.28534c0.15626,0.08492 0.32611,0.16475 0.50954,0.23949c0.18344,0.07473 0.36347,0.14267 0.54012,0.20382h-0.01019c0.19702,0.06794 0.41952,0.15626 0.6675,0.26496c0.24798,0.1087 0.48237,0.24798 0.70317,0.41783c0.2208,0.16985 0.40763,0.37366 0.5605,0.61145c0.15286,0.23779 0.22929,0.51973 0.22929,0.84584c0,0.3397 -0.06454,0.64033 -0.19363,0.90189c-0.12908,0.26157 -0.30912,0.48067 -0.54012,0.65731c-0.23099,0.17664 -0.50105,0.31082 -0.81017,0.40254c-0.30912,0.09172 -0.64372,0.13758 -1.0038,0.13758c-0.50954,0 -0.98512,-0.1087 -1.42672,-0.32611c-0.4416,-0.21741 -0.87641,-0.56389 -1.30443,-1.03947l0.8968,-0.73374c0.24458,0.3397 0.52143,0.58767 0.83056,0.74393c0.30912,0.15626 0.64712,0.23439 1.01399,0.23439c0.21061,0 0.40254,-0.02038 0.57578,-0.06115c0.17324,-0.04076 0.32271,-0.09851 0.4484,-0.17324c0.12569,-0.07473 0.2242,-0.16305 0.29554,-0.26496c0.07134,-0.10191 0.107,-0.21401 0.107,-0.3363c0,-0.16985 -0.05095,-0.31931 -0.15286,-0.4484c-0.10191,-0.12908 -0.23099,-0.24288 -0.38725,-0.34139c-0.15626,-0.09851 -0.3329,-0.18344 -0.52992,-0.25477c-0.19702,-0.07134 -0.38725,-0.13758 -0.57069,-0.19872l-0.24458,-0.09172c-0.23099,-0.08153 -0.45689,-0.16815 -0.67769,-0.25987c-0.2208,-0.09172 -0.41952,-0.21061 -0.59617,-0.35668c-0.17664,-0.14607 -0.31931,-0.32781 -0.42802,-0.54521c-0.1087,-0.21741 -0.16305,-0.48576 -0.16305,-0.80508c0,-0.25137 0.04416,-0.49596 0.13248,-0.73374c0.08832,-0.23779 0.2276,-0.4467 0.41783,-0.62674c0.19023,-0.18004 0.43481,-0.32441 0.73374,-0.43311c0.29893,-0.1087 0.65901,-0.16305 1.08023,-0.16305c0.24458,0 0.47897,0.02038 0.70317,0.06115c0.2242,0.04076 0.4416,0.1104 0.65222,0.20891c0.21061,0.09851 0.41613,0.2276 0.61655,0.38725c0.20042,0.15966 0.39914,0.35838 0.59617,0.59617l-0.94775,0.75412z" fill-rule="nonzero"/><path d="M316.79215,290.95921c0,-0.46878 0.06284,-0.92057 0.18853,-1.35538c0.12569,-0.43481 0.31931,-0.82036 0.58088,-1.15666c0.26157,-0.3363 0.59277,-0.60466 0.99361,-0.80508c0.40084,-0.20042 0.87302,-0.30063 1.41653,-0.30063c0.57748,0 1.07853,0.1155 1.50315,0.34649c0.42462,0.23099 0.80678,0.54691 1.14647,0.94775l-0.80508,0.71336c-0.29214,-0.36008 -0.58597,-0.60126 -0.88151,-0.72355c-0.29554,-0.12229 -0.60975,-0.18344 -0.94265,-0.18344c-0.36008,0 -0.6726,0.06964 -0.93756,0.20891c-0.26496,0.13928 -0.48407,0.32611 -0.65731,0.5605c-0.17324,0.23439 -0.30063,0.50445 -0.38216,0.81017c-0.08153,0.30573 -0.12229,0.62164 -0.12229,0.94775c0,0.32611 0.04076,0.64202 0.12229,0.94775c0.08153,0.30573 0.20891,0.57748 0.38216,0.81527c0.17324,0.23779 0.39235,0.42802 0.65731,0.57069c0.26496,0.14267 0.57748,0.21401 0.93756,0.21401c0.3329,0 0.64882,-0.06624 0.94775,-0.19872c0.29893,-0.13248 0.59107,-0.37876 0.87641,-0.73884l0.80508,0.71336c-0.3329,0.40084 -0.71336,0.72015 -1.14138,0.95794c-0.42802,0.23779 -0.93077,0.35668 -1.50825,0.35668c-0.54351,0 -1.01569,-0.10361 -1.41653,-0.31082c-0.40084,-0.20721 -0.73204,-0.48067 -0.99361,-0.82036c-0.26157,-0.3397 -0.45519,-0.72865 -0.58088,-1.16685c-0.12569,-0.43821 -0.18853,-0.8883 -0.18853,-1.35029z" fill-rule="nonzero"/><path d="M330.71626,290.96941c0,-0.3329 -0.04586,-0.65222 -0.13758,-0.95794c-0.09172,-0.30573 -0.23099,-0.57578 -0.41783,-0.81017c-0.18683,-0.23439 -0.41952,-0.41952 -0.69807,-0.5554c-0.27855,-0.13588 -0.60466,-0.20382 -0.97832,-0.20382c-0.36687,0 -0.68958,0.06794 -0.96813,0.20382c-0.27855,0.13588 -0.50954,0.31931 -0.69298,0.55031c-0.18344,0.23099 -0.32271,0.49935 -0.41783,0.80508c-0.09511,0.30573 -0.14267,0.62844 -0.14267,0.96813c0,0.3397 0.04756,0.66241 0.14267,0.96813c0.09511,0.30573 0.23439,0.57578 0.41783,0.81017c0.18344,0.23439 0.41443,0.42122 0.69298,0.5605c0.27855,0.13928 0.60126,0.20891 0.96813,0.20891c0.37366,0 0.69977,-0.06794 0.97832,-0.20382c0.27855,-0.13588 0.51124,-0.32101 0.69807,-0.5554c0.18683,-0.23439 0.32611,-0.50445 0.41783,-0.81017c0.09172,-0.30573 0.13758,-0.63183 0.13758,-0.97832zM331.82707,290.95921c0,0.47557 -0.06964,0.93416 -0.20891,1.37577c-0.13928,0.4416 -0.34989,0.83056 -0.63183,1.16685c-0.28195,0.3363 -0.63183,0.60636 -1.04966,0.81017c-0.41783,0.20382 -0.90189,0.30573 -1.4522,0.30573c-0.55031,0 -1.03267,-0.10191 -1.4471,-0.30573c-0.41443,-0.20382 -0.76262,-0.47388 -1.04456,-0.81017c-0.28195,-0.3363 -0.49256,-0.72525 -0.63183,-1.16685c-0.13928,-0.4416 -0.20891,-0.90019 -0.20891,-1.37577c0,-0.46878 0.06964,-0.92227 0.20891,-1.36048c0.13928,-0.43821 0.34989,-0.82376 0.63183,-1.15666c0.28195,-0.3329 0.63014,-0.59956 1.04456,-0.79998c0.41443,-0.20042 0.8968,-0.30063 1.4471,-0.30063c0.55031,0 1.03437,0.10021 1.4522,0.30063c0.41783,0.20042 0.76771,0.46708 1.04966,0.79998c0.28195,0.3329 0.49256,0.71846 0.63183,1.15666c0.13928,0.43821 0.20891,0.8917 0.20891,1.36048z" fill-rule="nonzero"/><path d="M339.65705,294.56678v-4.85085l-2.09932,3.42413l-2.12989,-3.36298v4.78971h-1.07004v-7.1336h0.84584l2.35409,3.75024l2.35409,-3.75024h0.83565v7.1336z" fill-rule="nonzero"/><path d="M348.57745,294.56678v-4.85085l-2.09932,3.42413l-2.12989,-3.36298v4.78971h-1.07004v-7.1336h0.84584l2.35409,3.75024l2.35409,-3.75024h0.83565v7.1336z" fill-rule="nonzero"/><path d="M352.1986,294.56678v-7.1336h4.40245v1.10061h-3.30184v1.7834h3.0063v1.10061h-3.0063v2.04836h3.33241v1.10061z" fill-rule="nonzero"/><path d="M361.53683,291.68277h-1.27386v2.88401h-1.10061v-7.1336h2.71077c0.29214,0 0.56559,0.05605 0.82036,0.16815c0.25477,0.1121 0.47897,0.26496 0.6726,0.45859c0.19363,0.19363 0.34649,0.41952 0.45859,0.67769c0.1121,0.25817 0.16815,0.53332 0.16815,0.82546c0,0.42802 -0.11719,0.81527 -0.35158,1.16176c-0.23439,0.34649 -0.53162,0.60466 -0.8917,0.77451l1.61016,3.06745h-1.24329zM360.26297,290.58215h1.61016c0.14267,0 0.27515,-0.02548 0.39744,-0.07643c0.12229,-0.05095 0.22929,-0.12229 0.32101,-0.21401c0.09172,-0.09172 0.16475,-0.20042 0.2191,-0.32611c0.05435,-0.12569 0.08153,-0.25987 0.08153,-0.40254c0,-0.28534 -0.09851,-0.52653 -0.29554,-0.72355c-0.19702,-0.19702 -0.43821,-0.29893 -0.72355,-0.30573h-1.61016z" fill-rule="nonzero"/><path d="M366.89043,290.95921c0,-0.46878 0.06284,-0.92057 0.18853,-1.35538c0.12569,-0.43481 0.31931,-0.82036 0.58088,-1.15666c0.26157,-0.3363 0.59277,-0.60466 0.99361,-0.80508c0.40084,-0.20042 0.87302,-0.30063 1.41653,-0.30063c0.57748,0 1.07853,0.1155 1.50315,0.34649c0.42462,0.23099 0.80678,0.54691 1.14647,0.94775l-0.80508,0.71336c-0.29214,-0.36008 -0.58597,-0.60126 -0.88151,-0.72355c-0.29554,-0.12229 -0.60975,-0.18344 -0.94265,-0.18344c-0.36008,0 -0.6726,0.06964 -0.93756,0.20891c-0.26496,0.13928 -0.48407,0.32611 -0.65731,0.5605c-0.17324,0.23439 -0.30063,0.50445 -0.38216,0.81017c-0.08153,0.30573 -0.12229,0.62164 -0.12229,0.94775c0,0.32611 0.04076,0.64202 0.12229,0.94775c0.08153,0.30573 0.20891,0.57748 0.38216,0.81527c0.17324,0.23779 0.39235,0.42802 0.65731,0.57069c0.26496,0.14267 0.57748,0.21401 0.93756,0.21401c0.3329,0 0.64882,-0.06624 0.94775,-0.19872c0.29893,-0.13248 0.59107,-0.37876 0.87641,-0.73884l0.80508,0.71336c-0.3329,0.40084 -0.71336,0.72015 -1.14138,0.95794c-0.42802,0.23779 -0.93077,0.35668 -1.50825,0.35668c-0.54351,0 -1.01569,-0.10361 -1.41653,-0.31082c-0.40084,-0.20721 -0.73204,-0.48067 -0.99361,-0.82036c-0.26157,-0.3397 -0.45519,-0.72865 -0.58088,-1.16685c-0.12569,-0.43821 -0.18853,-0.8883 -0.18853,-1.35029z" fill-rule="nonzero"/><path d="M375.25034,294.56678v-7.1336h1.10061v7.1336z" fill-rule="nonzero"/><path d="M383.07013,292.51842h-2.24199l-0.72355,2.04836h-1.2229l2.54772,-7.1336h1.03947l2.54772,7.1336h-1.2229zM381.21539,291.42799h1.45729c-0.06794,-0.19702 -0.13078,-0.37366 -0.18853,-0.52992c-0.05775,-0.15626 -0.1138,-0.31082 -0.16815,-0.46368c-0.05435,-0.15286 -0.1104,-0.31082 -0.16815,-0.47388c-0.05775,-0.16305 -0.12399,-0.35328 -0.19872,-0.57069z" fill-rule="nonzero"/><path d="M387.54731,294.56678v-7.1336h1.10061v6.03299h3.32222v1.10061z" fill-rule="nonzero"/><path d="M394.50088,294.56678v-7.1336h4.40245v1.10061h-3.30184v1.7834h3.0063v1.10061h-3.0063v2.04836h3.33241v1.10061z" fill-rule="nonzero"/><path d="M405.69384,289.15543c-0.19023,-0.23099 -0.39914,-0.39744 -0.62674,-0.49935c-0.2276,-0.10191 -0.49426,-0.15286 -0.79998,-0.15286c-0.39405,0 -0.70147,0.07643 -0.92227,0.22929c-0.2208,0.15286 -0.3312,0.338 -0.3312,0.5554c0,0.13588 0.04926,0.25647 0.14777,0.36178c0.09851,0.10531 0.2259,0.20042 0.38216,0.28534c0.15626,0.08492 0.32611,0.16475 0.50954,0.23949c0.18344,0.07473 0.36347,0.14267 0.54012,0.20382h-0.01019c0.19702,0.06794 0.41952,0.15626 0.6675,0.26496c0.24798,0.1087 0.48237,0.24798 0.70317,0.41783c0.2208,0.16985 0.40763,0.37366 0.5605,0.61145c0.15286,0.23779 0.22929,0.51973 0.22929,0.84584c0,0.3397 -0.06454,0.64033 -0.19363,0.90189c-0.12908,0.26157 -0.30912,0.48067 -0.54012,0.65731c-0.23099,0.17664 -0.50105,0.31082 -0.81017,0.40254c-0.30912,0.09172 -0.64372,0.13758 -1.0038,0.13758c-0.50954,0 -0.98512,-0.1087 -1.42672,-0.32611c-0.4416,-0.21741 -0.87641,-0.56389 -1.30443,-1.03947l0.8968,-0.73374c0.24458,0.3397 0.52143,0.58767 0.83056,0.74393c0.30912,0.15626 0.64712,0.23439 1.01399,0.23439c0.21061,0 0.40254,-0.02038 0.57578,-0.06115c0.17324,-0.04076 0.32271,-0.09851 0.4484,-0.17324c0.12569,-0.07473 0.2242,-0.16305 0.29554,-0.26496c0.07134,-0.10191 0.107,-0.21401 0.107,-0.3363c0,-0.16985 -0.05095,-0.31931 -0.15286,-0.4484c-0.10191,-0.12908 -0.23099,-0.24288 -0.38725,-0.34139c-0.15626,-0.09851 -0.3329,-0.18344 -0.52992,-0.25477c-0.19702,-0.07134 -0.38725,-0.13758 -0.57069,-0.19872l-0.24458,-0.09172c-0.23099,-0.08153 -0.45689,-0.16815 -0.67769,-0.25987c-0.2208,-0.09172 -0.41952,-0.21061 -0.59617,-0.35668c-0.17664,-0.14607 -0.31931,-0.32781 -0.42802,-0.54521c-0.1087,-0.21741 -0.16305,-0.48576 -0.16305,-0.80508c0,-0.25137 0.04416,-0.49596 0.13248,-0.73374c0.08832,-0.23779 0.2276,-0.4467 0.41783,-0.62674c0.19023,-0.18004 0.43481,-0.32441 0.73374,-0.43311c0.29893,-0.1087 0.65901,-0.16305 1.08023,-0.16305c0.24458,0 0.47897,0.02038 0.70317,0.06115c0.2242,0.04076 0.4416,0.1104 0.65222,0.20891c0.21061,0.09851 0.41613,0.2276 0.61655,0.38725c0.20042,0.15966 0.39914,0.35838 0.59617,0.59617l-0.94775,0.75412z" fill-rule="nonzero"/><path d="M133.37856,301.16487c0,1.24938 0.62469,1.87407 1.87407,1.87407h278.06693c1.24938,0 1.87407,-0.62469 1.87407,-1.87407v-22.2555c0,-1.24938 -0.62469,-1.87407 -1.87407,-1.87407h-278.06693c-1.24938,0 -1.87407,0.62469 -1.87407,1.87407zM413.31957,302.28931h-278.06693c-0.74963,0 -1.12444,-0.37481 -1.12444,-1.12444v-22.2555c0,-0.74963 0.37481,-1.12444 1.12444,-1.12444h278.06693c0.74963,0 1.12444,0.37481 1.12444,1.12444v22.2555c0,0.74963 -0.37481,1.12444 -1.12444,1.12444z" fill-rule="evenodd"/></g><g fill-rule="nonzero"><path d="M141.86268,268.22119h20.2017c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-101.04644c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-20.2017c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v101.04644c0,0.05819 0.04722,0.10541 0.10541,0.10541z"/><path d="M175.08584,225.88051h26.58762c4.04085,0 7.89955,-1.22524 11.15786,-3.54333c5.1337,-3.62512 8.1989,-9.5363 8.1989,-15.81344c0,-10.67299 -8.68293,-19.35676 -19.35676,-19.35676h-26.58762c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v38.50272c0,0.05819 0.04722,0.10541 0.10541,0.10541zM327.37817,187.38201c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.21013c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-86.24912c-0.00084,0 -0.00253,0.00169 -0.00337,0.00169h-39.45221c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541c0,0.05819 0.04722,0.10541 0.10541,0.10541c21.69762,0 39.35018,17.65256 39.35018,39.35018c0,13.26092 -6.60854,25.53693 -17.67786,32.84115c-5.84287,3.87473 -12.65041,6.10765 -19.68732,6.45844c-0.64761,0.03373 -1.31547,0.05059 -1.985,0.05059h-26.58762c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v22.13527c0,0.05819 0.04722,0.10541 0.10541,0.10541h66.0432c0.00084,0 0.00084,-0.00084 0.00169,-0.00084h86.24659c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.20929c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-65.93358v-19.99932h45.73273c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.20845c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-45.73273v-19.99848z"/><path d="M380.79097,268.19758c12.96494,0 25.92989,-4.93469 35.80011,-14.80491c0.04048,-0.04132 0.04048,-0.10793 0,-0.14925l-14.28969,-14.29053c-0.03963,-0.03963 -0.10878,-0.03963 -0.1501,0c-11.77765,11.77849 -30.943,11.77849 -42.72065,0c-5.70626,-5.70542 -8.84821,-13.29128 -8.84821,-21.36032c0,-8.06904 3.14279,-15.6549 8.84821,-21.36117c11.77765,-11.77849 30.943,-11.77849 42.72065,0c0.04132,0.03963 0.11046,0.03963 0.1501,0l14.28969,-14.29053c0.04048,-0.04132 0.04048,-0.10793 0,-0.14925c-19.74044,-19.74044 -51.85977,-19.74044 -71.60021,0c-9.56243,9.56243 -14.82852,22.27609 -14.82852,35.80011c0,13.52402 5.26609,26.23767 14.82852,35.80011c9.87022,9.87106 22.83516,14.80575 35.80011,14.80575z"/></g></g>
            </svg>
        </div>
        <div class="institution">Institut privé des études commerciales</div>
        <h1 class="document-title">Attestation d'Inscription</h1>
        <div class="document-number">N° ${documentNumber}</div>
    </div>
    
    <div class="date-location">
        Bruxelles, le ${currentDate.toLocaleDateString('fr-FR')}
    </div>
    
    <div class="certification">
        Je soussigné, Directeur de l'Institut Privé des Études Commerciales (IPEC), 
        certifie que <strong>${student.firstName} ${student.lastName}</strong>${student.dateOfBirth ? `, né(e) le ${new Date(student.dateOfBirth).toLocaleDateString('fr-FR')}` : ''}${student.countryOfBirth ? ` à ${student.countryOfBirth}` : ''}, 
        est dûment inscrit(e) dans notre établissement pour l'année académique ${student.registrationYear}-${student.registrationYear + 1}.
    </div>
    
    <div class="student-details">
        <div class="detail-row">
            <span class="label">Nom :</span>
            <span class="value">${student.firstName} ${student.lastName}</span>
        </div>
        <div class="detail-row">
            <span class="label">Référence :</span>
            <span class="value">${student.reference}</span>
        </div>
        <div class="detail-row">
            <span class="label">Email :</span>
            <span class="value">${student.email}</span>
        </div>
        <div class="detail-row">
            <span class="label">Inscription :</span>
            <span class="value">${new Date(student.registrationDate).toLocaleDateString('fr-FR')}</span>
        </div>
        <div class="detail-row">
            <span class="label">Statut :</span>
            <span class="value">${student.status}</span>
        </div>
    </div>
    
    <div class="program-section">
        <div class="program-title">${student.program}</div>
        <div class="program-details">
            ${student.specialty ? `${student.specialty} • ` : ''}${student.studyYear}${student.studyYear === 1 ? 'ère' : 'ème'} année
        </div>
    </div>
    
    <div class="certification">
        L'étudiant(e) suit régulièrement les cours et est en règle avec les exigences administratives.
    </div>
    
    <div class="validity-text">
        Cette attestation est délivrée pour servir et valoir ce que de droit.
    </div>
    
    <div class="signature-section">
        <div class="signature-block">
            <div class="signature-line"></div>
            <div class="signature-label">Cachet de l'Institution</div>
        </div>
        <div class="signature-block">
            <div class="signature-line"></div>
            <div class="signature-label">Le Directeur</div>
        </div>
    </div>
    
    <div class="footer">
        <strong>Institut Privé des Études Commerciales - Bruxelles</strong>
    </div>
</body>
</html>
  `;
};

export const generateInvoice = (student: Student, payment: Payment): string => {
  const invoiceNumber = payment.invoiceNumber || generateInvoiceNumber();
  
  return `
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facture ${invoiceNumber} - IPEC</title>
    <style>
        @page {
            size: A4;
            margin: 0;
        }
        
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 0; 
            line-height: 1.4; 
            color: #333;
            font-size: 11pt;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: white;
            z-index: 1000;
            padding: 20px;
        }
        
        .content {
            flex: 1;
            margin-top: 140px;
            margin-bottom: 80px;
            padding: 0 20px;
            overflow-y: auto;
        }
        
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            z-index: 1000;
        }
        
        .header-content { 
            display: flex; 
            justify-content: space-between; 
            border-bottom: 2px solid #2563eb; 
            padding-bottom: 15px; 
        }
        
        .logo { 
            color: #2563eb; 
            font-size: 20px; 
            font-weight: bold; 
        }
        
        .company-info {
            font-size: 11px;
            line-height: 1.3;
        }
        
        .invoice-info { 
            text-align: right;
            font-size: 11px;
        }
        
        .invoice-info h1 {
            font-size: 16px;
            margin: 0 0 5px 0;
        }
        
        .billing-info { 
            display: flex; 
            justify-content: space-between; 
            margin: 15px 0; 
        }
        
        .billing-section { 
            width: 45%;
            font-size: 11px;
        }
        
        .billing-section h3 {
            font-size: 12px;
            margin: 0 0 5px 0;
        }
        
        .invoice-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 15px 0; 
            font-size: 11px;
        }
        
        .invoice-table th, .invoice-table td { 
            border: 1px solid #d1d5db; 
            padding: 8px; 
            text-align: left; 
        }
        
        .invoice-table th { 
            background-color: #f3f4f6;
            font-size: 10px;
        }
        
        .total { 
            text-align: right; 
            font-size: 14px; 
            font-weight: bold; 
            color: #2563eb; 
            margin: 15px 0;
        }
        
        .footer { 
            padding: 15px 20px; 
            border-top: 1px solid #d1d5db; 
            text-align: center;
            font-size: 10px;
        }
        
        @media print {
            body { 
                margin: 0;
                height: 100vh;
            }
            .header {
                position: fixed;
                top: 0;
            }
            .footer {
                position: fixed;
                bottom: 0;
            }
            .content {
                margin-top: 140px;
                margin-bottom: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div>
                <div class="logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="133.38 166.96 283.24 136.08" style="height: 20px; width: auto; fill: #2563eb; vertical-align: middle;">
                        <g><g><path d="M141.75727,294.56678v-7.1336h1.10061v7.1336z" fill-rule="nonzero"/><path d="M150.30061,294.56678l-3.83176,-5.08524v5.08524h-1.08023v-7.1336h0.86622l3.86234,5.07505v-5.07505h1.08023v7.1336z" fill-rule="nonzero"/><path d="M157.95735,289.15543c-0.19023,-0.23099 -0.39914,-0.39744 -0.62674,-0.49935c-0.2276,-0.10191 -0.49426,-0.15286 -0.79998,-0.15286c-0.39405,0 -0.70147,0.07643 -0.92227,0.22929c-0.2208,0.15286 -0.3312,0.338 -0.3312,0.5554c0,0.13588 0.04926,0.25647 0.14777,0.36178c0.09851,0.10531 0.2259,0.20042 0.38216,0.28534c0.15626,0.08492 0.32611,0.16475 0.50954,0.23949c0.18344,0.07473 0.36347,0.14267 0.54012,0.20382h-0.01019c0.19702,0.06794 0.41952,0.15626 0.6675,0.26496c0.24798,0.1087 0.48237,0.24798 0.70317,0.41783c0.2208,0.16985 0.40763,0.37366 0.5605,0.61145c0.15286,0.23779 0.22929,0.51973 0.22929,0.84584c0,0.3397 -0.06454,0.64033 -0.19363,0.90189c-0.12908,0.26157 -0.30912,0.48067 -0.54012,0.65731c-0.23099,0.17664 -0.50105,0.31082 -0.81017,0.40254c-0.30912,0.09172 -0.64372,0.13758 -1.0038,0.13758c-0.50954,0 -0.98512,-0.1087 -1.42672,-0.32611c-0.4416,-0.21741 -0.87641,-0.56389 -1.30443,-1.03947l0.8968,-0.73374c0.24458,0.3397 0.52143,0.58767 0.83056,0.74393c0.30912,0.15626 0.64712,0.23439 1.01399,0.23439c0.21061,0 0.40254,-0.02038 0.57578,-0.06115c0.17324,-0.04076 0.32271,-0.09851 0.4484,-0.17324c0.12569,-0.07473 0.2242,-0.16305 0.29554,-0.26496c0.07134,-0.10191 0.107,-0.21401 0.107,-0.3363c0,-0.16985 -0.05095,-0.31931 -0.15286,-0.4484c-0.10191,-0.12908 -0.23099,-0.24288 -0.38725,-0.34139c-0.15626,-0.09851 -0.3329,-0.18344 -0.52992,-0.25477c-0.19702,-0.07134 -0.38725,-0.13758 -0.57069,-0.19872l-0.24458,-0.09172c-0.23099,-0.08153 -0.45689,-0.16815 -0.67769,-0.25987c-0.2208,-0.09172 -0.41952,-0.21061 -0.59617,-0.35668c-0.17664,-0.14607 -0.31931,-0.32781 -0.42802,-0.54521c-0.1087,-0.21741 -0.16305,-0.48576 -0.16305,-0.80508c0,-0.25137 0.04416,-0.49596 0.13248,-0.73374c0.08832,-0.23779 0.2276,-0.4467 0.41783,-0.62674c0.19023,-0.18004 0.43481,-0.32441 0.73374,-0.43311c0.29893,-0.1087 0.65901,-0.16305 1.08023,-0.16305c0.24458,0 0.47897,0.02038 0.70317,0.06115c0.2242,0.04076 0.4416,0.1104 0.65222,0.20891c0.21061,0.09851 0.41613,0.2276 0.61655,0.38725c0.20042,0.15966 0.39914,0.35838 0.59617,0.59617l-0.94775,0.75412z" fill-rule="nonzero"/><path d="M164.40137,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/><path d="M168.59321,294.56678v-7.1336h1.10061v7.1336z" fill-rule="nonzero"/><path d="M175.01685,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/><path d="M182.09271,294.63812c-0.17664,0 -0.3397,-0.01019 -0.48916,-0.03057c-0.3329,-0.04756 -0.64202,-0.13588 -0.92737,-0.26496c-0.28534,-0.12908 -0.53502,-0.29723 -0.74903,-0.50445c-0.21401,-0.20721 -0.38386,-0.45179 -0.50954,-0.73374c-0.12569,-0.28195 -0.19532,-0.59617 -0.20891,-0.94265v-4.72856h1.10061v4.61646c0,0.24458 0.04246,0.45519 0.12739,0.63183c0.08492,0.17664 0.19872,0.32441 0.34139,0.4433c0.14267,0.11889 0.30912,0.21061 0.49935,0.27515c0.19023,0.06454 0.39405,0.107 0.61145,0.12739c0.03397,0.00679 0.05945,0.01019 0.07643,0.01019c0.01698,0 0.03567,0 0.05605,0h0.15286c0.02038,0 0.03906,0 0.05605,0c0.01698,0 0.04246,-0.0034 0.07643,-0.01019c0.21741,-0.02038 0.42292,-0.06284 0.61655,-0.12739c0.19363,-0.06454 0.36178,-0.15626 0.50445,-0.27515c0.14267,-0.11889 0.25647,-0.26666 0.34139,-0.4433c0.08492,-0.17664 0.12739,-0.38725 0.12739,-0.63183v-4.61646h1.10061v4.72856c-0.01359,0.34649 -0.08323,0.66071 -0.20891,0.94265c-0.12569,0.28195 -0.29554,0.52823 -0.50954,0.73884c-0.21401,0.21061 -0.46538,0.38046 -0.75412,0.50954c-0.28874,0.12908 -0.60296,0.21401 -0.94265,0.25477l-0.35668,0.03057z" fill-rule="nonzero"/><path d="M190.32013,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/></g><g fill-rule="nonzero"><path d="M141.86268,268.22119h20.2017c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-101.04644c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-20.2017c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v101.04644c0,0.05819 0.04722,0.10541 0.10541,0.10541z"/><path d="M175.08584,225.88051h26.58762c4.04085,0 7.89955,-1.22524 11.15786,-3.54333c5.1337,-3.62512 8.1989,-9.5363 8.1989,-15.81344c0,-10.67299 -8.68293,-19.35676 -19.35676,-19.35676h-26.58762c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v38.50272c0,0.05819 0.04722,0.10541 0.10541,0.10541zM327.37817,187.38201c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.21013c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-86.24912c-0.00084,0 -0.00253,0.00169 -0.00337,0.00169h-39.45221c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541c0,0.05819 0.04722,0.10541 0.10541,0.10541c21.69762,0 39.35018,17.65256 39.35018,39.35018c0,13.26092 -6.60854,25.53693 -17.67786,32.84115c-5.84287,3.87473 -12.65041,6.10765 -19.68732,6.45844c-0.64761,0.03373 -1.31547,0.05059 -1.985,0.05059h-26.58762c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v22.13527c0,0.05819 0.04722,0.10541 0.10541,0.10541h66.0432c0.00084,0 0.00084,-0.00084 0.00169,-0.00084h86.24659c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.20929c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-65.93358v-19.99932h45.73273c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.20845c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-45.73273v-19.99848z"/><path d="M380.79097,268.19758c12.96494,0 25.92989,-4.93469 35.80011,-14.80491c0.04048,-0.04132 0.04048,-0.10793 0,-0.14925l-14.28969,-14.29053c-0.03963,-0.03963 -0.10878,-0.03963 -0.1501,0c-11.77765,11.77849 -30.943,11.77849 -42.72065,0c-5.70626,-5.70542 -8.84821,-13.29128 -8.84821,-21.36032c0,-8.06904 3.14279,-15.6549 8.84821,-21.36117c11.77765,-11.77849 30.943,-11.77849 42.72065,0c0.04132,0.03963 0.11046,0.03963 0.1501,0l14.28969,-14.29053c0.04048,-0.04132 0.04048,-0.10793 0,-0.14925c-19.74044,-19.74044 -51.85977,-19.74044 -71.60021,0c-9.56243,9.56243 -14.82852,22.27609 -14.82852,35.80011c0,13.52402 5.26609,26.23767 14.82852,35.80011c9.87022,9.87106 22.83516,14.80575 35.80011,14.80575z"/></g></g>
                    </svg>
                </div>
                <div class="company-info">
                    <strong>Institut privé des études commerciales</strong><br>
                    Avenue Louise 123<br>
                    1050 Bruxelles, Belgique<br>
                    Tél: +32 2 123 45 67<br>
                    Email: info@ipec.be
                </div>
            </div>
            <div class="invoice-info">
                <h1>FACTURE</h1>
                <p><strong>N° ${invoiceNumber}</strong></p>
                <p>Date: ${payment.invoiceDate ? new Date(payment.invoiceDate).toLocaleDateString('fr-FR') : new Date().toLocaleDateString('fr-FR')}</p>
                <p>Échéance: ${new Date(payment.dueDate).toLocaleDateString('fr-FR')}</p>
            </div>
        </div>
    </div>
    
    <div class="content">
        
        <div class="billing-info">
            <div class="billing-section">
                <h3>Facturé à:</h3>
                <p><strong>${student.firstName} ${student.lastName}</strong><br>
                ${student.email}<br>
                ${student.phone || ''}<br>
                ${student.address || ''}</p>
            </div>
            <div class="billing-section">
                <h3>Émetteur:</h3>
                <p><strong>Institut privé des études commerciales</strong><br>
                Avenue Louise 123<br>
                1050 Bruxelles, Belgique</p>
            </div>
        </div>
        
        <table class="invoice-table">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Type</th>
                    <th>Programme</th>
                    <th>Montant</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>${payment.description}</td>
                    <td>${payment.type}</td>
                    <td>${student.program}</td>
                    <td>${payment.amount}€</td>
                </tr>
            </tbody>
        </table>
        
        <div class="total">
            <p>Total à payer: ${payment.amount}€</p>
        </div>
    </div>
    
    <div class="footer">
        <p>Merci de votre confiance. Paiement dû avant le ${new Date(payment.dueDate).toLocaleDateString('fr-FR')}.</p>
        <p><strong>Institut privé des études commerciales - IPEC</strong></p>
    </div>
</body>
</html>
  `;
};

export const generateCreditNote = (student: Student, payment: Payment, reason: string): string => {
  const creditNumber = generateCreditNoteNumber();
  
  return `
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Note de crédit ${creditNumber} - IPEC Bruxelles</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
        .header { display: flex; justify-content: space-between; border-bottom: 2px solid #dc2626; padding-bottom: 20px; margin-bottom: 30px; }
        .logo { color: #2563eb; font-size: 24px; font-weight: bold; }
        .credit-info { text-align: right; }
        .credit-note { color: #dc2626; font-weight: bold; }
        .billing-info { display: flex; justify-content: space-between; margin: 20px 0; }
        .billing-section { width: 45%; }
        .credit-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .credit-table th, .credit-table td { border: 1px solid #d1d5db; padding: 12px; text-align: left; }
        .credit-table th { background-color: #fef2f2; }
        .total { text-align: right; font-size: 18px; font-weight: bold; color: #dc2626; }
        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #d1d5db; text-align: center; }
    </style>
</head>
<body>
    <div class="header">
        <div>
            <div class="logo">IPEC BRUXELLES</div>
            <p>Institut de Formation d'Excellence<br>
            Bruxelles, Belgique</p>
        </div>
        <div class="credit-info">
            <h1 class="credit-note">NOTE DE CRÉDIT</h1>
            <p><strong>N° ${creditNumber}</strong></p>
            <p>Date: ${new Date().toLocaleDateString('fr-FR')}</p>
            <p>Facture originale: ${payment.invoiceNumber || 'N/A'}</p>
        </div>
    </div>
    
    <div class="billing-info">
        <div class="billing-section">
            <h3>Crédité à:</h3>
            <p><strong>${student.firstName} ${student.lastName}</strong><br>
            ${student.email}<br>
            ${student.phone || ''}<br>
            ${student.address || ''}</p>
        </div>
        <div class="billing-section">
            <h3>Émetteur:</h3>
            <p><strong>IPEC Bruxelles</strong><br>
            Institut de Formation d'Excellence<br>
            Bruxelles, Belgique</p>
        </div>
    </div>
    
    <div style="margin: 20px 0; padding: 15px; background-color: #fef2f2; border-left: 4px solid #dc2626;">
        <h3>Motif du remboursement:</h3>
        <p>${reason}</p>
    </div>
    
    <table class="credit-table">
        <thead>
            <tr>
                <th>Description</th>
                <th>Type</th>
                <th>Programme</th>
                <th>Montant remboursé</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>${payment.description}</td>
                <td>${payment.type}</td>
                <td>${student.program}</td>
                <td>-${payment.amount}€</td>
            </tr>
        </tbody>
    </table>
    
    <div class="total">
        <p>Total remboursé: ${payment.amount}€</p>
    </div>
    
    <div class="footer">
        <p>Cette note de crédit annule la facture originale et confirme le remboursement.</p>
        <p><strong>IPEC Bruxelles</strong> - Excellence en formation</p>
    </div>
</body>
</html>
  `;
};

export const generatePaymentSummary = (student: Student, payment: Payment): string => {
  const getTotalPaid = (): number => {
    if (!payment.installments) return payment.status === 'Payé' ? payment.amount : 0;
    return payment.installments.reduce((sum, inst) => sum + inst.amount, 0);
  };

  const getRemainingAmount = (): number => {
    return payment.amount - getTotalPaid();
  };

  return `
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Récapitulatif de paiement - IPEC</title>
    <style>
        @page {
            size: A4;
            margin: 0;
        }
        
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 0; 
            line-height: 1.3; 
            color: #333;
            font-size: 10pt;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: white;
            z-index: 1000;
            padding: 20px;
        }
        
        .content {
            flex: 1;
            margin-top: 140px;
            margin-bottom: 80px;
            padding: 0 20px;
            overflow-y: auto;
        }
        
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            z-index: 1000;
        }
        
        .header-content { 
            display: flex; 
            justify-content: space-between; 
            border-bottom: 2px solid #2563eb; 
            padding-bottom: 12px; 
        }
        
        .logo { 
            color: #2563eb; 
            font-size: 18px; 
            font-weight: bold; 
        }
        
        .company-info {
            font-size: 10px;
            line-height: 1.2;
        }
        
        .summary-info { 
            text-align: right;
            font-size: 10px;
        }
        
        .summary-info h1 {
            font-size: 14px;
            margin: 0 0 5px 0;
        }
        
        .billing-info { 
            display: flex; 
            justify-content: space-between; 
            margin: 12px 0; 
        }
        
        .billing-section { 
            width: 45%;
            font-size: 10px;
        }
        
        .billing-section h3 {
            font-size: 11px;
            margin: 0 0 5px 0;
        }
        
        .payment-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 12px 0; 
            font-size: 9pt;
        }
        
        .payment-table th, .payment-table td { 
            border: 1px solid #d1d5db; 
            padding: 6px; 
            text-align: left; 
        }
        
        .payment-table th { 
            background-color: #f3f4f6;
            font-size: 8pt;
        }
        
        .status-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 8px;
            font-weight: bold;
            color: white;
        }
        
        .status-paid { background-color: #22c55e; }
        .status-pending { background-color: #eab308; }
        .status-overdue { background-color: #ef4444; }
        .status-refunded { background-color: #3b82f6; }
        
        .total { 
            text-align: right; 
            font-size: 12px; 
            font-weight: bold; 
            color: #2563eb; 
            margin: 10px 0;
        }
        
        h3 {
            font-size: 11px;
            margin: 10px 0 5px 0;
            color: #2563eb;
        }
        
        .footer { 
            padding: 10px 20px; 
            border-top: 1px solid #d1d5db; 
            text-align: center;
            font-size: 9px;
        }
        
        @media print {
            body { 
                margin: 0;
                height: 100vh;
            }
            .header {
                position: fixed;
                top: 0;
            }
            .footer {
                position: fixed;
                bottom: 0;
            }
            .content {
                margin-top: 140px;
                margin-bottom: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div>
                <div class="logo">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="133.38 166.96 283.24 136.08" style="height: 18px; width: auto; fill: #2563eb; vertical-align: middle;">
                        <g><g><path d="M141.75727,294.56678v-7.1336h1.10061v7.1336z" fill-rule="nonzero"/><path d="M150.30061,294.56678l-3.83176,-5.08524v5.08524h-1.08023v-7.1336h0.86622l3.86234,5.07505v-5.07505h1.08023v7.1336z" fill-rule="nonzero"/><path d="M157.95735,289.15543c-0.19023,-0.23099 -0.39914,-0.39744 -0.62674,-0.49935c-0.2276,-0.10191 -0.49426,-0.15286 -0.79998,-0.15286c-0.39405,0 -0.70147,0.07643 -0.92227,0.22929c-0.2208,0.15286 -0.3312,0.338 -0.3312,0.5554c0,0.13588 0.04926,0.25647 0.14777,0.36178c0.09851,0.10531 0.2259,0.20042 0.38216,0.28534c0.15626,0.08492 0.32611,0.16475 0.50954,0.23949c0.18344,0.07473 0.36347,0.14267 0.54012,0.20382h-0.01019c0.19702,0.06794 0.41952,0.15626 0.6675,0.26496c0.24798,0.1087 0.48237,0.24798 0.70317,0.41783c0.2208,0.16985 0.40763,0.37366 0.5605,0.61145c0.15286,0.23779 0.22929,0.51973 0.22929,0.84584c0,0.3397 -0.06454,0.64033 -0.19363,0.90189c-0.12908,0.26157 -0.30912,0.48067 -0.54012,0.65731c-0.23099,0.17664 -0.50105,0.31082 -0.81017,0.40254c-0.30912,0.09172 -0.64372,0.13758 -1.0038,0.13758c-0.50954,0 -0.98512,-0.1087 -1.42672,-0.32611c-0.4416,-0.21741 -0.87641,-0.56389 -1.30443,-1.03947l0.8968,-0.73374c0.24458,0.3397 0.52143,0.58767 0.83056,0.74393c0.30912,0.15626 0.64712,0.23439 1.01399,0.23439c0.21061,0 0.40254,-0.02038 0.57578,-0.06115c0.17324,-0.04076 0.32271,-0.09851 0.4484,-0.17324c0.12569,-0.07473 0.2242,-0.16305 0.29554,-0.26496c0.07134,-0.10191 0.107,-0.21401 0.107,-0.3363c0,-0.16985 -0.05095,-0.31931 -0.15286,-0.4484c-0.10191,-0.12908 -0.23099,-0.24288 -0.38725,-0.34139c-0.15626,-0.09851 -0.3329,-0.18344 -0.52992,-0.25477c-0.19702,-0.07134 -0.38725,-0.13758 -0.57069,-0.19872l-0.24458,-0.09172c-0.23099,-0.08153 -0.45689,-0.16815 -0.67769,-0.25987c-0.2208,-0.09172 -0.41952,-0.21061 -0.59617,-0.35668c-0.17664,-0.14607 -0.31931,-0.32781 -0.42802,-0.54521c-0.1087,-0.21741 -0.16305,-0.48576 -0.16305,-0.80508c0,-0.25137 0.04416,-0.49596 0.13248,-0.73374c0.08832,-0.23779 0.2276,-0.4467 0.41783,-0.62674c0.19023,-0.18004 0.43481,-0.32441 0.73374,-0.43311c0.29893,-0.1087 0.65901,-0.16305 1.08023,-0.16305c0.24458,0 0.47897,0.02038 0.70317,0.06115c0.2242,0.04076 0.4416,0.1104 0.65222,0.20891c0.21061,0.09851 0.41613,0.2276 0.61655,0.38725c0.20042,0.15966 0.39914,0.35838 0.59617,0.59617l-0.94775,0.75412z" fill-rule="nonzero"/><path d="M164.40137,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/><path d="M168.59321,294.56678v-7.1336h1.10061v7.1336z" fill-rule="nonzero"/><path d="M175.01685,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/><path d="M182.09271,294.63812c-0.17664,0 -0.3397,-0.01019 -0.48916,-0.03057c-0.3329,-0.04756 -0.64202,-0.13588 -0.92737,-0.26496c-0.28534,-0.12908 -0.53502,-0.29723 -0.74903,-0.50445c-0.21401,-0.20721 -0.38386,-0.45179 -0.50954,-0.73374c-0.12569,-0.28195 -0.19532,-0.59617 -0.20891,-0.94265v-4.72856h1.10061v4.61646c0,0.24458 0.04246,0.45519 0.12739,0.63183c0.08492,0.17664 0.19872,0.32441 0.34139,0.4433c0.14267,0.11889 0.30912,0.21061 0.49935,0.27515c0.19023,0.06454 0.39405,0.107 0.61145,0.12739c0.03397,0.00679 0.05945,0.01019 0.07643,0.01019c0.01698,0 0.03567,0 0.05605,0h0.15286c0.02038,0 0.03906,0 0.05605,0c0.01698,0 0.04246,-0.0034 0.07643,-0.01019c0.21741,-0.02038 0.42292,-0.06284 0.61655,-0.12739c0.19363,-0.06454 0.36178,-0.15626 0.50445,-0.27515c0.14267,-0.11889 0.25647,-0.26666 0.34139,-0.4433c0.08492,-0.17664 0.12739,-0.38725 0.12739,-0.63183v-4.61646h1.10061v4.72856c-0.01359,0.34649 -0.08323,0.66071 -0.20891,0.94265c-0.12569,0.28195 -0.29554,0.52823 -0.50954,0.73884c-0.21401,0.21061 -0.46538,0.38046 -0.75412,0.50954c-0.28874,0.12908 -0.60296,0.21401 -0.94265,0.25477l-0.35668,0.03057z" fill-rule="nonzero"/><path d="M190.32013,288.53379v6.03299h-1.10061v-6.03299h-1.69168v-1.10061h4.45341v1.10061z" fill-rule="nonzero"/></g><g fill-rule="nonzero"><path d="M141.86268,268.22119h20.2017c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-101.04644c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-20.2017c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v101.04644c0,0.05819 0.04722,0.10541 0.10541,0.10541z"/><path d="M175.08584,225.88051h26.58762c4.04085,0 7.89955,-1.22524 11.15786,-3.54333c5.1337,-3.62512 8.1989,-9.5363 8.1989,-15.81344c0,-10.67299 -8.68293,-19.35676 -19.35676,-19.35676h-26.58762c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v38.50272c0,0.05819 0.04722,0.10541 0.10541,0.10541zM327.37817,187.38201c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.21013c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-86.24912c-0.00084,0 -0.00253,0.00169 -0.00337,0.00169h-39.45221c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541c0,0.05819 0.04722,0.10541 0.10541,0.10541c21.69762,0 39.35018,17.65256 39.35018,39.35018c0,13.26092 -6.60854,25.53693 -17.67786,32.84115c-5.84287,3.87473 -12.65041,6.10765 -19.68732,6.45844c-0.64761,0.03373 -1.31547,0.05059 -1.985,0.05059h-26.58762c-0.05819,0 -0.10541,0.04722 -0.10541,0.10541v22.13527c0,0.05819 0.04722,0.10541 0.10541,0.10541h66.0432c0.00084,0 0.00084,-0.00084 0.00169,-0.00084h86.24659c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.20929c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-65.93358v-19.99932h45.73273c0.05819,0 0.10541,-0.04722 0.10541,-0.10541v-20.20845c0,-0.05819 -0.04722,-0.10541 -0.10541,-0.10541h-45.73273v-19.99848z"/><path d="M380.79097,268.19758c12.96494,0 25.92989,-4.93469 35.80011,-14.80491c0.04048,-0.04132 0.04048,-0.10793 0,-0.14925l-14.28969,-14.29053c-0.03963,-0.03963 -0.10878,-0.03963 -0.1501,0c-11.77765,11.77849 -30.943,11.77849 -42.72065,0c-5.70626,-5.70542 -8.84821,-13.29128 -8.84821,-21.36032c0,-8.06904 3.14279,-15.6549 8.84821,-21.36117c11.77765,-11.77849 30.943,-11.77849 42.72065,0c0.04132,0.03963 0.11046,0.03963 0.1501,0l14.28969,-14.29053c0.04048,-0.04132 0.04048,-0.10793 0,-0.14925c-19.74044,-19.74044 -51.85977,-19.74044 -71.60021,0c-9.56243,9.56243 -14.82852,22.27609 -14.82852,35.80011c0,13.52402 5.26609,26.23767 14.82852,35.80011c9.87022,9.87106 22.83516,14.80575 35.80011,14.80575z"/></g></g>
                    </svg>
                </div>
                <div class="company-info">
                    <strong>Institut privé des études commerciales</strong><br>
                    Avenue Louise 123<br>
                    1050 Bruxelles, Belgique<br>
                    Tél: +32 2 123 45 67<br>
                    Email: info@ipec.be
                </div>
            </div>
            <div class="summary-info">
                <h1>RÉCAPITULATIF DE PAIEMENT</h1>
                <p><strong>Facture N° ${payment.invoiceNumber || 'N/A'}</strong></p>
                <p>Date: ${new Date().toLocaleDateString('fr-FR')}</p>
                <p>Échéance: ${new Date(payment.dueDate).toLocaleDateString('fr-FR')}</p>
            </div>
        </div>
    </div>
    
    <div class="content">
        
        <div class="billing-info">
            <div class="billing-section">
                <h3>Étudiant:</h3>
                <p><strong>${student.firstName} ${student.lastName}</strong><br>
                ${student.email}<br>
                ${student.phone || ''}<br>
                Référence: ${student.reference}<br>
                Programme: ${student.program}</p>
            </div>
            <div class="billing-section">
                <h3>Émetteur:</h3>
                <p><strong>Institut privé des études commerciales</strong><br>
                Avenue Louise 123<br>
                1050 Bruxelles, Belgique</p>
            </div>
        </div>
        
        <table class="payment-table">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Type</th>
                    <th>Montant total</th>
                    <th>Statut</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>${payment.description}</td>
                    <td>${payment.type}</td>
                    <td>${payment.amount}€</td>
                    <td>
                        <span class="status-badge ${payment.status === 'Payé' ? 'status-paid' : 
                          payment.status === 'En attente' ? 'status-pending' : 
                          payment.status === 'En retard' ? 'status-overdue' : 'status-refunded'}">
                            ${payment.status}
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
        
        ${payment.type === 'Minerval' && payment.installments && payment.installments.length > 0 ? `
        <h3>Historique des paiements</h3>
        <table class="payment-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Montant</th>
                    <th>Moyen</th>
                    <th>Acompte</th>
                </tr>
            </thead>
            <tbody>
                ${payment.installments.map((installment, index) => `
                <tr>
                    <td>${new Date(installment.paidDate).toLocaleDateString('fr-FR')}</td>
                    <td>${installment.amount}€</td>
                    <td>${installment.method}</td>
                    <td>#${index + 1}</td>
                </tr>
                `).join('')}
            </tbody>
        </table>
        
        <div class="total">
            <p>Total payé: ${getTotalPaid()}€ | Reste: ${getRemainingAmount()}€</p>
        </div>
        ` : ''}
        
        ${payment.status === 'Payé' && !payment.installments ? `
        <h3>Paiement effectué</h3>
        <table class="payment-table">
            <thead>
                <tr>
                    <th>Date de paiement</th>
                    <th>Montant payé</th>
                    <th>Moyen de paiement</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>${payment.paidDate ? new Date(payment.paidDate).toLocaleDateString('fr-FR') : 'N/A'}</td>
                    <td>${payment.amount}€</td>
                    <td>${payment.method || 'N/A'}</td>
                </tr>
            </tbody>
        </table>
        ` : ''}
    </div>
    
    <div class="footer">
        <p>Document généré le ${new Date().toLocaleDateString('fr-FR')} à ${new Date().toLocaleTimeString('fr-FR')}</p>
        <p><strong>Institut privé des études commerciales - IPEC</strong></p>
    </div>
</body>
</html>
  `;
};

export const downloadDocument = (content: string, filename: string) => {
  const blob = new Blob([content], { type: 'text/html' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = filename;
  link.click();
  URL.revokeObjectURL(url);
};